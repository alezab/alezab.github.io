# Laboratorium - ≈Åamanie Hase≈Ç

Data: 4 listopada 2025

## Spis tre≈õci

- [Wstƒôp - Podstawy ≈Çamania hase≈Ç](#wstƒôp---podstawy-≈Çamania-hase≈Ç)
- [Zadanie 4.1 - Przyk≈Çad MD5 z dictionary attack](#zadanie-41---przyk≈Çad-md5-z-dictionary-attack)
- [Zadanie 4.2 - SHA-1 dictionary attack](#zadanie-42---sha-1-dictionary-attack)
- [Zadanie 4.3 - SHA-256 dictionary attack](#zadanie-43---sha-256-dictionary-attack)
- [Zadanie 4.4 - SHA-512 dictionary attack](#zadanie-44---sha-512-dictionary-attack)
- [Zadanie 4.5 - bcrypt dictionary attack](#zadanie-45---bcrypt-dictionary-attack)
- [Zadanie 4.6 - scrypt dictionary attack](#zadanie-46---scrypt-dictionary-attack)
- [Zadanie 4.7 - MD5 z crunch (3 cyfry)](#zadanie-47---md5-z-crunch-3-cyfry)
- [Zadanie 4.8 - MD5 z crunch (4 wielkie litery)](#zadanie-48---md5-z-crunch-4-wielkie-litery)
- [Zadanie 4.9 - MD5 z crunch (pass + 4 cyfry)](#zadanie-49---md5-z-crunch-pass--4-cyfry)
- [Zadanie 4.10 - Permutacje s≈Ç√≥w](#zadanie-410---permutacje-s≈Ç√≥w)
- [Zadanie 4.11 - Wzorzec 5 znak√≥w](#zadanie-411---wzorzec-5-znak√≥w)
- [Zadanie 4.12 - Brute-force 4 ma≈Çe litery](#zadanie-412---brute-force-4-ma≈Çe-litery)
- [Zadanie 4.13 - Brute-force wielka + 3 cyfry](#zadanie-413---brute-force-wielka--3-cyfry)
- [Zadanie 4.14 - Custom character sets](#zadanie-414---custom-character-sets)
- [Zadanie 4.15 - Adres MAC](#zadanie-415---adres-mac)

---

## Wstƒôp - Podstawy ≈Çamania hase≈Ç

### Rodzaje atak√≥w

**Dictionary Attack (Atak s≈Çownikowy):**
- U≈ºywa gotowych list s≈Ç√≥w (wordlists)
- Szybki, ale ograniczony do s≈Ç√≥w w s≈Çowniku
- Najczƒô≈õciej u≈ºywany jako pierwszy krok

**Brute-force (Atak brutalnej si≈Çy):**
- Sprawdza wszystkie mo≈ºliwe kombinacje
- U≈ºywa masek do okre≈õlenia wzorca has≈Ça
- Wolniejszy, ale gwarantuje sukces dla ma≈Çych przestrzeni kluczy

**Hybrid Attack (Atak hybrydowy):**
- ≈ÅƒÖczy s≈Çownik z regu≈Çami lub maskami
- Np. s≈Çowo + cyfry na ko≈Ñcu

### Narzƒôdzia

**Hashcat:**
- Najpopularniejsze narzƒôdzie do ≈Çamania hase≈Ç
- Wspiera GPU i CPU
- Obs≈Çuguje setki typ√≥w hashy
- Tryby: dictionary (-a 0), brute-force (-a 3), hybrid (-a 6, -a 7)

**John the Ripper:**
- Alternatywa dla hashcat
- Dobry do prostych zada≈Ñ
- Mniej format√≥w ni≈º hashcat

**Crunch:**
- Generator wordlist
- Tworzy wszystkie kombinacje dla podanych parametr√≥w
- U≈ºywa wzorc√≥w (templates)

### Typy hashy

| Hash | Mode (hashcat) | D≈Çugo≈õƒá | Format | Przyk≈Çad zastosowania |
|------|----------------|---------|--------|----------------------|
| **MD5** | 0 | 32 hex | `5d41402abc4b2a76b9719d911017c592` | Stare systemy, kontrola integralno≈õci |
| **SHA-1** | 100 | 40 hex | `aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d` | Git commits, certyfikaty (przestarza≈Çe) |
| **SHA-256** | 1400 | 64 hex | `e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855` | Bitcoin, SSL/TLS |
| **SHA-512** | 1700 | 128 hex | bardzo d≈Çugi | Serwery Linux/Unix (shadow) |
| **bcrypt** | 3200 | zmienna | `$2b$12$...` | Has≈Ça aplikacji webowych |
| **scrypt** | 8900 | zmienna | `SCRYPT:1024:1:1:...` | Kryptowaluty, has≈Ça |

### Hashcat - podstawowe maski

| Maska | Znaczenie | Przyk≈Çad |
|-------|-----------|----------|
| `?l` | lowercase (a-z) | `?l?l?l` = abc, xyz |
| `?u` | uppercase (A-Z) | `?u?u` = AB, XY |
| `?d` | digit (0-9) | `?d?d?d` = 123, 999 |
| `?s` | special characters | `?s` = !, @, #, $ |
| `?a` | all printable | wszystkie znaki |
| `?h` | hex (0-9a-f) | u≈ºywane dla adres√≥w MAC |

### Crunch - wzorce (templates)

| Wzorzec | Znaczenie | Przyk≈Çad |
|---------|-----------|----------|
| `@` | lowercase (a-z) | `@@` = aa, ab, zz |
| `,` | uppercase (A-Z) | `,,` = AA, AB, ZZ |
| `%` | digit (0-9) | `%%%` = 000, 123, 999 |
| `^` | special characters | `^^` = !!, @# |

### Przyk≈Çadowe komendy

```bash
# Hashcat - dictionary attack
hashcat -a 0 -m 0 hash.txt wordlist.txt --force

# Hashcat - brute-force z maskƒÖ
hashcat -a 3 -m 0 hash.txt '?l?l?l?l' --force

# Hashcat - custom character sets
hashcat -a 3 -m 0 hash.txt -1 abc -2 468 '?1?2?2' --force

# Crunch - generowanie s≈Çownika
crunch 4 4 0123456789 -o digits.txt

# Crunch - z wzorcem
crunch 8 8 -t pass%%%% -o passwords.txt

# Crunch - permutacje
crunch 1 20 -p admin password 123 -o permutations.txt
```

---

## Zadanie 4.1 - Przyk≈Çad MD5 z dictionary attack

### Polecenie

Pod adresem `http://127.0.0.1:4001` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy dwa endpointy:
- `http://127.0.0.1:4001/hash` - pobieranie hashu MD5
- `http://127.0.0.1:4001/submit` - wysy≈Çanie z≈Çamanego has≈Ça

**Zadanie:** Z≈Çam hash MD5 u≈ºywajƒÖc dostƒôpnego s≈Çownika i wy≈õlij wynik na serwer.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4001:4001 --name ex1 docker.io/mazurkatarzyna/pass-cracking-ex1:latest
```

Lub zapasowy:
```bash
docker run -p 4001:4001 --name ex1 ghcr.io/mazurkatarzynaumcs/pass-cracking-ex1:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4001/hash | jq .
```

```json
{
  "hash": "19005ef9d4e2abbf7b029b61f094a286",
  "message": "Spr√≥buj z≈Çamaƒá ten hash!"
}
```

```bash
curl -s -X GET http://127.0.0.1:4001/hash | jq -r .hash > hash.txt
```

#### (c) Z≈Çamanie hashu hashcat

```bash
hashcat -a 0 -m 0 hash.txt slowniki/ex41/wordlist.txt --force
hashcat -a 0 -m 0 hash.txt --show
```

**Has≈Ço:** `kidney81`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4001/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "kidney81"}' | jq .
```

**Wyja≈õnienie:**
- `-a 0` - tryb dictionary attack
- `-m 0` - typ hashu MD5
- `--force` - wymusza dzia≈Çanie na CPU (bez GPU)

---

## Zadanie 4.2 - SHA-1 dictionary attack

### Polecenie

Pod adresem `http://127.0.0.1:4002` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy dwa endpointy:
- `http://127.0.0.1:4002/hash` - pobieranie hashu SHA-1
- `http://127.0.0.1:4002/submit` - wysy≈Çanie z≈Çamanego has≈Ça

**Zadanie:** Z≈Çam hash SHA-1 u≈ºywajƒÖc dostƒôpnego s≈Çownika.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4002:4002 --name ex2 docker.io/mazurkatarzyna/pass-cracking-ex2:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4002/hash | jq -r .hash > hash42.txt
```

**Hash:** `9d270ca213048cc46f762591f54b6a0d59390996`

#### (c) Z≈Çamanie hashu

**Hashcat:**
```bash
hashcat -a 0 -m 100 hash42.txt slowniki/ex42/wordlist.txt --force
hashcat -a 0 -m 100 hash42.txt slowniki/ex42/wordlist.txt --show
```

**John the Ripper (alternatywnie):**
```bash
john --wordlist=slowniki/ex42/wordlist.txt --format=raw-sha1 hash42.txt
john --show --format=raw-sha1 hash42.txt
```

**Has≈Ço:** `ronald`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4002/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "ronald"}' | jq .
```

```json
{
  "success": true,
  "message": "Gratulacje! Poprawnie z≈Çamano hash!"
}
```

---

## Zadanie 4.3 - SHA-256 dictionary attack

### Polecenie

Pod adresem `http://127.0.0.1:4003` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash SHA-256 do z≈Çamania.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4003:4003 --name ex3 docker.io/mazurkatarzyna/pass-cracking-ex3:latest
```

#### (b) Pobranie i z≈Çamanie hashu

```bash
curl -s -X GET http://127.0.0.1:4003/hash | jq -r .hash > hash43.txt
```

**Hash:** `8440c28681cf77c9c08e4a6570ee06451445dd3495abbed3add55c2e49e33f99`

**Hashcat:**
```bash
hashcat -a 0 -m 1400 hash43.txt slowniki/ex43/wordlist.txt --force
hashcat -a 0 -m 1400 hash43.txt slowniki/ex43/wordlist.txt --show
```

**John the Ripper:**
```bash
john --wordlist=slowniki/ex43/wordlist.txt --format=raw-sha256 hash43.txt
john --show --format=raw-sha256 hash43.txt
```

**Has≈Ço:** `juantech`

#### (c) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4003/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "juantech"}' | jq .
```

---

## Zadanie 4.4 - SHA-512 dictionary attack

### Polecenie

Pod adresem `http://127.0.0.1:4004` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash SHA-512 do z≈Çamania.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4004:4004 --name ex4 docker.io/mazurkatarzyna/pass-cracking-ex4:latest
```

#### (b) Pobranie i z≈Çamanie hashu

```bash
curl -s -X GET http://127.0.0.1:4004/hash | jq -r .hash > hash44.txt
```

**Hashcat:**
```bash
hashcat -a 0 -m 1700 hash44.txt slowniki/ex44/wordlist.txt --force
hashcat -a 0 -m 1700 hash44.txt slowniki/ex44/wordlist.txt --show
```

**John the Ripper:**
```bash
john --wordlist=slowniki/ex44/wordlist.txt --format=raw-sha512 hash44.txt
john --show --format=raw-sha512 hash44.txt
```

**Has≈Ço:** `user`

#### (c) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4004/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "user"}' | jq .
```

---

## Zadanie 4.5 - bcrypt dictionary attack

### Polecenie

Pod adresem `http://127.0.0.1:4005` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash bcrypt do z≈Çamania.

**Uwaga:** bcrypt jest wolny algorytm - ≈Çamanie mo≈ºe potrwaƒá d≈Çu≈ºej!

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4005:4005 --name ex5 docker.io/mazurkatarzyna/pass-cracking-ex5:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4005/hash | jq -r .hash > hash45.txt
```

**Hash:** `$2b$12$MPNRqsRHB6AtiSw2IToP.OY/TASME.QR/WvPKAseDObixxYFkMJ6q`

#### (c) Z≈Çamanie hashu

**Hashcat:**
```bash
hashcat -a 0 -m 3200 hash45.txt slowniki/ex45/wordlist.txt --force
hashcat -a 0 -m 3200 hash45.txt slowniki/ex45/wordlist.txt --show
```

**John the Ripper:**
```bash
john --wordlist=slowniki/ex45/wordlist.txt --format=bcrypt hash45.txt
john --show --format=bcrypt hash45.txt
```

**Has≈Ço:** `112502`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4005/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "112502"}' | jq .
```

**Wyja≈õnienie:**
- bcrypt jest specjalnie zaprojektowany aby byƒá wolnym
- U≈ºywany w aplikacjach webowych (np. Django, Rails)
- Format: `$2b$[cost]$[salt+hash]`

---

## Zadanie 4.6 - scrypt dictionary attack

### Polecenie

Pod adresem `http://127.0.0.1:4006` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash scrypt do z≈Çamania.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4006:4006 --name ex6 docker.io/mazurkatarzyna/pass-cracking-ex6:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4006/hash | jq -r .hash > hash46.txt
```

**Hash:** `SCRYPT:1024:1:1:9ykG9pP0G1kYLvnPAGbEYQ==:SRZa0KJpwmhV/0zHKjt4iwYbcXXDdfgn444eVJ+fcgc=`

#### (c) Z≈Çamanie hashu

**Hashcat (wymaga --self-test-disable):**
```bash
hashcat -a 0 -m 8900 hash46.txt slowniki/ex46/wordlist.txt --force --self-test-disable
hashcat -a 0 -m 8900 hash46.txt slowniki/ex46/wordlist.txt --show
```

**John the Ripper:**
```bash
john --wordlist=slowniki/ex46/wordlist.txt --format=scrypt hash46.txt
john --show --format=scrypt hash46.txt
```

**Has≈Ço:** `asdfgh`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4006/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "asdfgh"}' | jq .
```

**Wyja≈õnienie:**
- scrypt jest jeszcze wolniejszy ni≈º bcrypt
- U≈ºywany w kryptowalutach (Litecoin)
- Wymaga du≈ºo pamiƒôci RAM

---

## Zadanie 4.7 - MD5 z crunch (3 cyfry)

### Polecenie

Pod adresem `http://127.0.0.1:4007` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash MD5 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço sk≈Çada siƒô z 3 cyfr (0-9), wygeneruj s≈Çownik u≈ºywajƒÖc crunch i z≈Çam hash.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4007:4007 --name ex7 docker.io/mazurkatarzyna/pass-cracking-ex7:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4007/hash | jq -r .hash > hash47.txt
```

**Hash:** `24896ee4c6526356cc127852413ea3b4`

#### (c) Generowanie s≈Çownika

```bash
# Metoda 1: crunch do pliku
crunch 3 3 0123456789 -o dict47.txt

# S≈Çownik zawiera: 000, 001, ..., 998, 999 (1000 wpis√≥w)
```

#### (d) Z≈Çamanie hashu

**Hashcat ze s≈Çownikiem:**
```bash
hashcat -a 0 -m 0 hash47.txt dict47.txt --force
hashcat -a 0 -m 0 hash47.txt dict47.txt --show
```

**Lub hashcat z maskƒÖ (bez s≈Çownika):**
```bash
hashcat -a 3 -m 0 hash47.txt '?d?d?d' --force
```

**John the Ripper:**
```bash
john --wordlist=dict47.txt --format=raw-md5 hash47.txt
john --show --format=raw-md5 hash47.txt
```

**Has≈Ço:** `506`

#### (e) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4007/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "506"}' | jq .
```

**Wyja≈õnienie:**
- `crunch 3 3` - min i max d≈Çugo≈õƒá = 3
- `0123456789` - zestaw znak√≥w (cyfry)
- `-o dict47.txt` - zapisz do pliku

---

## Zadanie 4.8 - MD5 z crunch (4 wielkie litery)

### Polecenie

Pod adresem `http://127.0.0.1:4008` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash MD5 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço sk≈Çada siƒô z 4 wielkich liter (A-Z), wygeneruj s≈Çownik i z≈Çam hash.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4008:4008 --name ex8 docker.io/mazurkatarzyna/pass-cracking-ex8:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4008/hash | jq -r .hash > hash48.txt
```

**Hash:** `f28a39156f2588861c817ae2734b0fb3`

#### (c) Generowanie s≈Çownika

```bash
crunch 4 4 ABCDEFGHIJKLMNOPQRSTUVWXYZ -o dict48.txt
```

**S≈Çownik zawiera:** AAAA, AAAB, ..., ZZZZ (~456,976 wpis√≥w)

#### (d) Z≈Çamanie hashu

**Hashcat ze s≈Çownikiem:**
```bash
hashcat -a 0 -m 0 hash48.txt dict48.txt --force
hashcat -a 0 -m 0 hash48.txt dict48.txt --show
```

**Lub hashcat z maskƒÖ:**
```bash
hashcat -a 3 -m 0 hash48.txt '?u?u?u?u' --force
```

**John the Ripper:**
```bash
john --wordlist=dict48.txt --format=raw-md5 hash48.txt
john --show --format=raw-md5 hash48.txt
```

**Has≈Ço:** `TFKN`

#### (e) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4008/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "TFKN"}' | jq .
```

---

## Zadanie 4.9 - MD5 z crunch (pass + 4 cyfry)

### Polecenie

Pod adresem `http://127.0.0.1:4009` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash MD5 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço to s≈Çowo "pass" z sufiksem z 4 cyfr (np. pass0000, pass1234), wygeneruj s≈Çownik i z≈Çam hash.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4009:4009 --name ex9 docker.io/mazurkatarzyna/pass-cracking-ex9:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4009/hash | jq -r .hash > hash49.txt
```

**Hash:** `228cc33f0153287add65b6041e56a0c0`

#### (c) Generowanie s≈Çownika

```bash
# W crunch: % = cyfra (0-9)
crunch 8 8 -t pass%%%% -o dict49.txt
```

**S≈Çownik zawiera:** pass0000, pass0001, ..., pass9999 (10,000 wpis√≥w)

#### (d) Z≈Çamanie hashu

**Hashcat ze s≈Çownikiem:**
```bash
hashcat -a 0 -m 0 hash49.txt dict49.txt --force
hashcat -a 0 -m 0 hash49.txt dict49.txt --show
```

**Lub hashcat z maskƒÖ:**
```bash
hashcat -a 3 -m 0 hash49.txt 'pass?d?d?d?d' --force
```

**John the Ripper:**
```bash
john --wordlist=dict49.txt --format=raw-md5 hash49.txt
john --show --format=raw-md5 hash49.txt
```

**Has≈Ço:** `pass####` (przyk≈Çad: pass1234)

**UWAGA:** Ten serwer mo≈ºe mieƒá b≈ÇƒÖd - je≈õli nie dzia≈Ça, zrestartuj Docker.

#### (e) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4009/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "pass1234"}' | jq .
```

**Wyja≈õnienie wzorc√≥w crunch:**
- `%` - cyfra (0-9)
- `@` - ma≈Ça litera (a-z)
- `,` - wielka litera (A-Z)
- `^` - znak specjalny

---

## Zadanie 4.10 - Permutacje s≈Ç√≥w

### Polecenie

Pod adresem `http://127.0.0.1:4010` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash MD5 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço to permutacje s≈Ç√≥w: admin, password, 123, wygeneruj s≈Çownik i z≈Çam hash.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4010:4010 --name ex10 docker.io/mazurkatarzyna/pass-cracking-ex10:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4010/hash | jq -r .hash > hash410.txt
```

**Hash:** `eeffe703e9206c22ffa09e74edaee793`

#### (c) Generowanie s≈Çownika permutacji

```bash
# Flaga -p generuje wszystkie permutacje podanych s≈Ç√≥w
crunch 1 20 -p admin password 123 > dict410.txt
```

**S≈Çownik zawiera 6 permutacji:**
```
123adminpassword
123passwordadmin
admin123password
adminpassword123
password123admin
passwordadmin123
```

#### (d) Z≈Çamanie hashu

**Hashcat:**
```bash
hashcat -a 0 -m 0 hash410.txt dict410.txt --force
hashcat -a 0 -m 0 hash410.txt dict410.txt --show
```

**John the Ripper:**
```bash
john --wordlist=dict410.txt --format=raw-md5 hash410.txt
john --show --format=raw-md5 hash410.txt
```

**Has≈Ço:** `admin123password`

#### (e) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4010/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "admin123password"}' | jq .
```

**Wyja≈õnienie:**
- `-p` - generuje permutacje (wszystkie mo≈ºliwe kolejno≈õci)
- Dla 3 element√≥w: 3! = 6 permutacji
- `crunch 1 20` - min=1, max=20 (aby pomie≈õciƒá najd≈Çu≈ºszƒÖ permutacjƒô)

---

## Zadanie 4.11 - Wzorzec 5 znak√≥w

### Polecenie

Pod adresem `http://127.0.0.1:4011` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash MD5 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço ma wzorzec:
- Znak 1: wielka litera (A-Z)
- Znak 2: ma≈Ça litera (a-z)
- Znak 3: cyfra (0-9)
- Znaki 4-5: znaki specjalne (!, @, #, $, %, ^, &, *, itd.)

Wygeneruj s≈Çownik i z≈Çam hash.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4011:4011 --name ex11 docker.io/mazurkatarzyna/pass-cracking-ex11:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4011/hash | jq -r .hash > hash411.txt
```

**Hash:** `68793f841751bef32d2e000242e782f9`

#### (c) Generowanie s≈Çownika

```bash
# W crunch:
# , = wielka litera (A-Z)
# @ = ma≈Ça litera (a-z)
# % = cyfra (0-9)
# ^ = znaki specjalne
crunch 5 5 -t ',@%^^' -o dict411.txt
```

**S≈Çownik zawiera ~7.3 miliona kombinacji**

#### (d) Z≈Çamanie hashu

**Hashcat ze s≈Çownikiem:**
```bash
hashcat -a 0 -m 0 hash411.txt dict411.txt --force
hashcat -a 0 -m 0 hash411.txt dict411.txt --show
```

**Lub hashcat z maskƒÖ:**
```bash
# ?u = wielka litera, ?l = ma≈Ça litera, ?d = cyfra, ?s = znaki specjalne
hashcat -a 3 -m 0 hash411.txt '?u?l?d?s?s' --force
```

**John the Ripper:**
```bash
john --wordlist=dict411.txt --format=raw-md5 hash411.txt
john --show --format=raw-md5 hash411.txt
```

**Has≈Ço:** `Xe3*!`

#### (e) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4011/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "Xe3*!"}' | jq .
```

---

## Zadanie 4.12 - Brute-force 4 ma≈Çe litery

### Polecenie

Pod adresem `http://127.0.0.1:4012` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash SHA-1 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço sk≈Çada siƒô z 4 ma≈Çych liter (a-z), z≈Çam hash u≈ºywajƒÖc brute-force (bez s≈Çownika).

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4012:4012 --name ex12 docker.io/mazurkatarzyna/pass-cracking-ex12:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4012/hash | jq -r .hash > hash412.txt
```

**Hash:** `2223b2b645cd955097e7c922dc4100a845f602d2`

#### (c) Z≈Çamanie hashu brute-force

**Hashcat z maskƒÖ:**
```bash
# ?l = ma≈Ça litera (a-z)
hashcat -a 3 -m 100 hash412.txt '?l?l?l?l' --force
hashcat -a 3 -m 100 hash412.txt '?l?l?l?l' --show
```

**John the Ripper:**
```bash
john --mask='?l?l?l?l' --format=raw-sha1 hash412.txt
john --show --format=raw-sha1 hash412.txt
```

**Has≈Ço:** `dstt`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4012/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "dstt"}' | jq .
```

**Wyja≈õnienie:**
- `-a 3` - tryb brute-force (mask attack)
- `-m 100` - SHA-1
- `?l?l?l?l` - 4 ma≈Çe litery
- Przestrze≈Ñ kluczy: 26^4 = 456,976 kombinacji

---

## Zadanie 4.13 - Brute-force wielka + 3 cyfry

### Polecenie

Pod adresem `http://127.0.0.1:4013` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash SHA-1 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço sk≈Çada siƒô z 1 wielkiej litery + 3 cyfr (np. A123, Z999), z≈Çam hash u≈ºywajƒÖc brute-force.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4013:4013 --name ex13 docker.io/mazurkatarzyna/pass-cracking-ex13:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4013/hash | jq -r .hash > hash413.txt
```

**Hash:** `62a222f55419948764ebc96ec2c26d42824bcd41`

#### (c) Z≈Çamanie hashu

**Hashcat:**
```bash
# ?u = wielka litera (A-Z), ?d = cyfra (0-9)
hashcat -a 3 -m 100 hash413.txt '?u?d?d?d' --force
hashcat -a 3 -m 100 hash413.txt '?u?d?d?d' --show
```

**John the Ripper:**
```bash
john --mask='?u?d?d?d' --format=raw-sha1 hash413.txt
john --show --format=raw-sha1 hash413.txt
```

**Has≈Ço:** `R538`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4013/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "R538"}' | jq .
```

**Wyja≈õnienie:**
- Przestrze≈Ñ kluczy: 26 √ó 10^3 = 26,000 kombinacji
- Bardzo szybkie do z≈Çamania

---

## Zadanie 4.14 - Custom character sets

### Polecenie

Pod adresem `http://127.0.0.1:4014` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash SHA-1 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço ma wzorzec:
- Znak 1: litera z {a, b, c}
- Znak 2: cyfra z {4, 6, 8}
- Znak 3: znak specjalny z {*, %, :}

Z≈Çam hash u≈ºywajƒÖc custom character sets.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4014:4014 --name ex14 docker.io/mazurkatarzyna/pass-cracking-ex14:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4014/hash | jq -r .hash > hash414.txt
```

**Hash:** `0b26fa991a9d529f604215255e970a2c2fc971a6`

#### (c) Z≈Çamanie hashu

**Hashcat z custom character sets:**
```bash
# -1 abc = zestaw 1: a, b, c
# -2 468 = zestaw 2: 4, 6, 8
# -3 *%: = zestaw 3: *, %, :
hashcat -a 3 -m 100 hash414.txt -1 abc -2 468 -3 '*%:' '?1?2?3' --force
hashcat -a 3 -m 100 hash414.txt -1 abc -2 468 -3 '*%:' '?1?2?3' --show
```

**Lub crunch + john:**
```bash
crunch 3 3 -t '@%^' -1 abc -2 468 -3 '*%:' > dict414.txt
john --wordlist=dict414.txt --format=raw-sha1 hash414.txt
john --show --format=raw-sha1 hash414.txt
```

**Has≈Ço:** `a4:`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4014/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "a4:"}' | jq .
```

**Wyja≈õnienie:**
- `-1`, `-2`, `-3` - definiujƒÖ custom character sets
- `?1`, `?2`, `?3` - odnoszƒÖ siƒô do zestaw√≥w w masce
- Przestrze≈Ñ kluczy: 3 √ó 3 √ó 3 = 27 kombinacji

---

## Zadanie 4.15 - Adres MAC

### Polecenie

Pod adresem `http://127.0.0.1:4015` dzia≈Ça prosty serwer HTTP udostƒôpniajƒÖcy hash SHA-1 do z≈Çamania.

**Zadanie:** WiedzƒÖc, ≈ºe has≈Ço to adres MAC w formacie:
- Prefix: `00:14:22:ff:ff:` (sta≈Çy)
- Suffix: XX (2 znaki hex: 0-9, a-f)

Z≈Çam hash u≈ºywajƒÖc brute-force.

### RozwiƒÖzanie

#### (a) Uruchomienie serwera

```bash
docker run -p 4015:4015 --name ex15 docker.io/mazurkatarzyna/pass-cracking-ex15:latest
```

#### (b) Pobranie hashu

```bash
curl -s -X GET http://127.0.0.1:4015/hash | jq -r .hash > hash415.txt
```

**Hash:** `5540dfe65be6a76560e2b19b3771b38aa44dcd8f`

#### (c) Z≈Çamanie hashu

**Hashcat z custom hex charset:**
```bash
# -1 0123456789abcdef = charset hex
hashcat -a 3 -m 100 hash415.txt -1 0123456789abcdef '00:14:22:ff:ff:?1?1' --force
hashcat -a 3 -m 100 hash415.txt -1 0123456789abcdef '00:14:22:ff:ff:?1?1' --show
```

**Lub z hashcat hex charset ?h:**
```bash
# ?h = hex (0-9a-f)
hashcat -a 3 -m 100 hash415.txt '00:14:22:ff:ff:?h?h' --force
```

**Lub crunch + john:**
```bash
crunch 17 17 -t '00:14:22:ff:ff:@@' -1 0123456789abcdef > dict415.txt
john --wordlist=dict415.txt --format=raw-sha1 hash415.txt
john --show --format=raw-sha1 hash415.txt
```

**Has≈Ço:** `00:14:22:ff:ff:d0`

#### (d) Wys≈Çanie wyniku

```bash
curl -s -X POST http://127.0.0.1:4015/submit \
  -H "Content-Type: application/json" \
  -d '{"word": "00:14:22:ff:ff:d0"}' | jq .
```

**Wyja≈õnienie:**
- OUI (Organizationally Unique Identifier): `00:14:22` - Dell
- Przestrze≈Ñ kluczy: 16^2 = 256 kombinacji (00-ff)
- `?h` w hashcat = hex digit (0-9a-f)

---

## Podsumowanie

### Uko≈Ñczone zadania

| Zadanie | Typ hashu | Metoda | Has≈Ço | Czas |
|---------|-----------|--------|-------|------|
| 4.2 | SHA-1 | Dictionary | ronald | Szybko |
| 4.3 | SHA-256 | Dictionary | juantech | Szybko |
| 4.4 | SHA-512 | Dictionary | user | Szybko |
| 4.5 | bcrypt | Dictionary | 112502 | Wolno |
| 4.6 | scrypt | Dictionary | asdfgh | Bardzo wolno |
| 4.7 | MD5 | Crunch (3 cyfry) | 506 | Szybko |
| 4.8 | MD5 | Crunch (4 wielkie) | TFKN | Szybko |
| 4.9 | MD5 | Crunch (pass+4 cyfry) | pass#### | B≈ÇƒÖd serwera |
| 4.10 | MD5 | Permutacje | admin123password | Szybko |
| 4.11 | MD5 | Wzorzec 5 znak√≥w | Xe3*! | ≈örednio |
| 4.12 | SHA-1 | Brute-force (4 ma≈Çe) | dstt | Szybko |
| 4.13 | SHA-1 | Brute-force (wielka+3) | R538 | Bardzo szybko |
| 4.14 | SHA-1 | Custom sets | a4: | Bardzo szybko |
| 4.15 | SHA-1 | MAC address | 00:14:22:ff:ff:d0 | Bardzo szybko |

### Hashcat - tryby ataku

| Tryb | Nazwa | U≈ºycie | Przyk≈Çad |
|------|-------|--------|----------|
| `-a 0` | Dictionary | Gotowy s≈Çownik | `hashcat -a 0 -m 0 hash.txt wordlist.txt` |
| `-a 3` | Brute-force | Maski | `hashcat -a 3 -m 0 hash.txt '?l?l?l?l'` |
| `-a 6` | Hybrid (dict+mask) | S≈Çownik + cyfry | `hashcat -a 6 -m 0 hash.txt dict.txt '?d?d'` |
| `-a 7` | Hybrid (mask+dict) | Cyfry + s≈Çownik | `hashcat -a 7 -m 0 hash.txt '?d?d' dict.txt` |

### Hashcat - maski (charset built-in)

| Maska | Opis | Przyk≈Çad |
|-------|------|----------|
| `?l` | Lowercase (a-z) | `?l?l?l` = abc |
| `?u` | Uppercase (A-Z) | `?u?u` = AB |
| `?d` | Digit (0-9) | `?d?d?d` = 123 |
| `?s` | Special | `?s?s` = !@ |
| `?a` | All printable | `?a?a?a` = A2! |
| `?h` | Hex (0-9a-f) | `?h?h` = a3 |
| `?b` | Binary (0x00-0xff) | wszystkie bajty |

### Crunch - wzorce (templates)

| Wzorzec | Opis | Przyk≈Çad |
|---------|------|----------|
| `@` | Lowercase (a-z) | `@@@` = abc |
| `,` | Uppercase (A-Z) | `,,,` = ABC |
| `%` | Digit (0-9) | `%%%` = 123 |
| `^` | Special | `^^` = !@ |

### Typy hashy - por√≥wnanie

| Hash | Bezpiecze≈Ñstwo | Szybko≈õƒá ≈Çamania | Zastosowanie |
|------|----------------|------------------|--------------|
| **MD5** | ‚ùå S≈Çabe | ‚ö° Bardzo szybkie | Przestarza≈Çe |
| **SHA-1** | ‚ùå S≈Çabe | ‚ö° Bardzo szybkie | Git (nie do hase≈Ç) |
| **SHA-256** | ‚úÖ Dobre* | ‚ö° Szybkie | Bitcoin, SSL |
| **SHA-512** | ‚úÖ Dobre* | ‚ö° Szybkie | Linux/Unix |
| **bcrypt** | ‚úÖ‚úÖ Bardzo dobre | üêå Wolne | Web apps |
| **scrypt** | ‚úÖ‚úÖ‚úÖ Najlepsze | üêåüêå Bardzo wolne | Kryptowaluty |

*SHA-2 jest bezpieczny, ale szybki - dla hase≈Ç lepiej u≈ºyƒá bcrypt/scrypt

### Najlepsze praktyki

**Generowanie s≈Çownik√≥w:**
1. U≈ºywaj crunch dla ma≈Çych przestrzeni kluczy (< 10 milion√≥w)
2. Dla wiƒôkszych - u≈ºywaj masek w hashcat
3. Permutacje (`-p`) dla znanych s≈Ç√≥w

**≈Åamanie hase≈Ç:**
1. Zacznij od dictionary attack (najszybszy)
2. Je≈õli nie dzia≈Ça, spr√≥buj brute-force z maskƒÖ
3. Dla wolnych hashy (bcrypt/scrypt) u≈ºywaj ma≈Çych s≈Çownik√≥w

**Bezpiecze≈Ñstwo:**
- Minimum 12 znak√≥w dla hase≈Ç
- Mieszaj wielkie, ma≈Çe, cyfry, znaki specjalne
- U≈ºywaj bcrypt/scrypt zamiast MD5/SHA-1
- Nigdy nie u≈ºywaj prostych wzorc√≥w

### Przydatne komendy

```bash
# Sprawdzenie d≈Çugo≈õci hashu
echo -n "hash" | wc -c

# Generowanie w≈Çasnego hashu MD5
echo -n "password" | md5sum

# Generowanie SHA-256
echo -n "password" | sha256sum

# Sprawdzenie typu hashu (hashid)
hashid 'hash_string'

# Benchmark hashcat
hashcat -b

# Lista dostƒôpnych typ√≥w hashy
hashcat --example-hashes | grep -i "md5"
```

### Workspace i narzƒôdzia

**Zainstalowane:**
- Hashcat 7.1.2
- John the Ripper
- Crunch
- OpenSSL
- jq

**Struktura folder√≥w:**
```
2025-11-04/
‚îú‚îÄ‚îÄ 04-11-25.txt          # Oryginalne notatki
‚îú‚îÄ‚îÄ 2025-11-04.md         # Ten plik Markdown
‚îú‚îÄ‚îÄ hash4*.txt            # Pobrane hashe
‚îú‚îÄ‚îÄ dict4*.txt            # Wygenerowane s≈Çowniki
‚îî‚îÄ‚îÄ slowniki/             # Gotowe wordlisty
    ‚îú‚îÄ‚îÄ ex41/
    ‚îú‚îÄ‚îÄ ex42/
    ‚îî‚îÄ‚îÄ ...
```

### R√≥≈ºnice miƒôdzy hashcat a john

| Cecha | Hashcat | John the Ripper |
|-------|---------|-----------------|
| **Szybko≈õƒá** | Bardzo szybki (GPU) | Wolniejszy (CPU) |
| **Formaty** | 300+ typ√≥w | Mniej format√≥w |
| **Maski** | Zaawansowane | Podstawowe |
| **UI** | Linia komend | Linia komend |
| **GPU** | Tak | Nie (OpenCL w wersji Jumbo) |
| **Prostota** | ≈örednia | Prosta |

### Czas ≈Çamania - przyk≈Çady

**MD5 (CPU, 12 rdzeni):**
- 4 ma≈Çe litery: < 1 sekunda
- 8 ma≈Çych liter: ~2 godziny
- 12 ma≈Çych liter: ~500 lat

**bcrypt (cost=12):**
- S≈Çownik 1000 s≈Ç√≥w: ~10 sekund
- S≈Çownik 1 milion: ~3 godziny
- Brute-force 6 znak√≥w: ~10 lat

**Wnioski:**
- MD5/SHA-1 NIE nadajƒÖ siƒô do hase≈Ç
- U≈ºywaj bcrypt z cost >= 10
- D≈Çugo≈õƒá has≈Ça > algorytm hashu
